全局设置
----------------
点击左下角设置按钮 或 快捷键“ctrl”+“，”进入全局设置页面。

.. image:: _images/全局设置-进入.png


-----


系统
~~~~~~~~~~~~~~

.. image:: _images/全局-系统27.png

- **选择本地Home路径** : 可修改Kf_home存放路径，目录路径不允许包含中文。

- **全局日志级别** ：对系统内所有日志级别进行设置，低于设置级别的日志将再不展示（如默认为info级别日志，不会显示级别更高的trace、debug级别日志）。

- **语言** ：界面语言，目前支持中文、English(修改后重启客户端生效)。

- **交易进程自动重启** : 如果打开， 交易进程出错后， 会继续尝试重连三次。如果关闭， 则不进行任何重试操作。重启过程中（即重启开始到交易进程就绪）， 策略内查询到的持仓会为0， 需要在策略内通过 on_deregister， on_broker_state_change这两个方法来判断柜台状态为断开/就绪。

- **跳过归档** : 开启后， 每次启动会删除所有 journal， 且仅保留当日 runtime 目录下 log， 跳过归档后无法恢复之前的内存数据， 会加快启动速度。

- **跳过归档（开发者模式）** ：非开发者请勿开启此选项。开启后，每次启动客户端时不进行任何归档操作，保留所有 journal 和 log 文件，帮助开发者更快地使用诊断工具排查问题, 重启后生效。当普通跳过归档与开发者跳过归档同时开启时，开发者模式跳过归档功能优先生效。

-----


性能
~~~~~~~~~~~~~~

.. image:: _images/全局设置-性能27.png


- **开启极速模式** ： (仅当CPU核数大于4时才允许开启)开启极速模式会极大的降低系统延迟，并会使 CPU 使用效率达到100%，重启后生效。

- **跳过UI进程计算** ：UI进程不再处理计算逻辑，完全通过计算进程更新数据，减轻UI进程性能占用，重启后生效。

- **纯监控模式** : 该模式下仅监控进程运行状态，UI性能占用可以达到最低，重启后生效。

- **跳过持仓行情订阅** : 打开后，不再默认订阅交易账户持仓的行情更新，浮动盈亏以及市值相关字段使用开仓均价计算，开启后可减轻机器性能负担，重启后生效。


-----


策略
~~~~~~~~~~~~~~

.. image:: _images/全局设置-策略27.png


当某些模块在功夫内置的python中没有时，可以使用本地python，将所需模块下载到本地使用  **本地Python版本必须是 3.9.x 版本** 。
- 使用本地python ：开启后使用本地python。
- 选择python路径 ：
 - 选择本地python的可执行程序。
 - 安装.whl文件 ：进入功夫的安装目录(快捷进入:左上角-文件-功夫安装目录)，依次进入 Kungfu -> resources -> app -> dist -> public - > python文件夹，打开cmd ， pip install kungfu-2.4.0-xxxx.whl 。


-----


币种
~~~~~~~~~

.. image:: _images/全局设置-币种27.png

打开后，持仓面板标的列展示标的币种（仅支持otc柜台显示币种）

-----


交易
~~~~~~~~~~~~~~

.. image:: _images/全局设置-交易.png

- **成交提示音** ：开启后，下单成交时会发出提示音。

- **乌龙指阈值** ：在用户下单时，若检测到买价高于市场价过多或卖价低于市场价过多时弹窗提示。

.. note::   **乌龙指阈值** 触发机制：

    - 用户手动下单，委托方向为 **买** 时，当委托价 **高于** 最新价 ×（1 + 阈值）时，系统将弹窗提醒。
    - 用户手动下单，委托方向为 **卖** 时，当委托价 **低于** 最新价 ×（1 - 阈值）时，系统将弹窗提醒。

- **平仓阈值** :在用户下单时，若检测到扣除平仓数量后，仓位低于平仓阈值，将弹窗提示。

.. note::   **平仓阈值** 触发机制：
   
   - 用户平仓时，当（持仓量-平仓量） / 持仓量 < 平仓阈值时，系统将弹窗提醒。

- **跳过下单确认弹窗** ： 打开后，用户在“下单面板”点击下单按钮后，将直接下单，不再弹出确认弹窗。

- **交易限制** : 可对具体标的进行成交量、成交价的限制。

- **持仓表格项配置** ： 默认勾选昨（昨仓剩余量）+今，配置后，将在“持仓”“持仓汇总”面板显示，用户可根据需求自行配置。

.. warning:: 建议在持仓表格配置项中不要勾选2个“昨”。勾选后，持仓面板不会对2个昨进行特殊标识，均显示“昨”，可能造成混淆。

- **跳过每分钟一次的持仓同步** ：当未使用功夫客户端以外系统进行下单时，建议开启。开启后，仅通过本地维护持仓，可避免传输延迟导致同步柜台持仓、本地持仓计算时序错误带来的风险。

-----


代码编辑器
~~~~~~~~~~~~~~

.. image:: _images/全局设置-代码编辑器27.png


- **缩进类别** ：可选择使用“TAB”键或"Space"键作为缩进按钮。

- **缩进长度** ：以空格为标准，选择一个缩进的距离，可以选择两个空格或者四个空格。


-----

版本更新
~~~~~~~~~~~~~~~~~~~~~~~~~

.. image:: _images/全局设置-版本更新27.png

- **版本更新** ：开启后，每次启动客户端将检测是否有新版本发布。

-----


期货手续费
~~~~~~~~~~~~~~~~

.. image:: _images/全局-手续费.png


账户中拥有的持仓标的会自动请求交易所对应的手续费，没有持仓时，需要手动设置。

-----

定时任务
~~~~~~~~~~~~~~~~~~~~~

.. image:: _images/全局-定时任务27.png

- **定时任务** ：用户可添加定时任务，达到不重启客户端情况下，每日自动重启td、md等进程/自动启动结束策略的效果。

-----